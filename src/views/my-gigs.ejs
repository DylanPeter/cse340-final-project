<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title><%= title %></title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <%- include('partials/navbar') %>

  <div class="container">
    <h1>My Gigs</h1>

    <% if (successMessage) { %>
      <div class="success-message"><%= successMessage %></div>
    <% } %>

    <!-- Filters -->
    <form action="/my-gigs" method="GET">
      <input
        type="text"
        name="search"
        placeholder="Search by title or location"
        value="<%= searchTerm || '' %>"
      />

      <label for="startDate">From:</label>
      <input
        type="date"
        name="startDate"
        value="<%= startDate || '' %>"
      />

      <label for="endDate">To:</label>
      <input
        type="date"
        name="endDate"
        value="<%= endDate || '' %>"
      />

      <button type="submit">Filter</button>
      <a href="/my-gigs" class="ml-2">Clear</a>
    </form>

    <% if (gigs.length === 0) { %>
      <p>You havenâ€™t posted any gigs yet.</p>
      <a href="/add-gig">Add Your First Gig</a>
    <% } else { %>
      <table>
        <tr>
          <th>Title</th>
          <th>Location</th>
          <th>Date</th>
          <th>Actions</th>
        </tr>
        <% gigs.forEach(gig => { %>
          <tr>
            <td><%= gig.title %></td>
            <td><%= gig.location %></td>
            <td><%= new Date(gig.date).toLocaleDateString() %></td>
            <td>
              <a href="/edit-gig/<%= gig.id %>">Edit</a>
              <form action="/delete-gig/<%= gig.id %>" method="POST" style="display:inline;">
                <button type="submit" onclick="return confirm('Delete this gig?')">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </table>
    <% } %>
  </div>
</body>
</html>
